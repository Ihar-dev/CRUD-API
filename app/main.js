(()=>{var e={371:(e,s,t)=>{t(738).config(Object.assign({},t(547),t(962)(process.argv)))},962:e=>{const s=/^dotenv_config_(encoding|path|debug|override)=(.+)$/;e.exports=function(e){return e.reduce((function(e,t){const n=t.match(s);return n&&(e[n[1]]=n[2]),e}),{})}},547:e=>{const s={};null!=process.env.DOTENV_CONFIG_ENCODING&&(s.encoding=process.env.DOTENV_CONFIG_ENCODING),null!=process.env.DOTENV_CONFIG_PATH&&(s.path=process.env.DOTENV_CONFIG_PATH),null!=process.env.DOTENV_CONFIG_DEBUG&&(s.debug=process.env.DOTENV_CONFIG_DEBUG),null!=process.env.DOTENV_CONFIG_OVERRIDE&&(s.override=process.env.DOTENV_CONFIG_OVERRIDE),e.exports=s},738:(e,s,t)=>{const n=t(147),r=t(17),i=t(37),o=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function c(e){console.log(`[dotenv][DEBUG] ${e}`)}const a={config:function(e){let s=r.resolve(process.cwd(),".env"),t="utf8";const o=Boolean(e&&e.debug),u=Boolean(e&&e.override);var d;e&&(null!=e.path&&(s="~"===(d=e.path)[0]?r.join(i.homedir(),d.slice(1)):d),null!=e.encoding&&(t=e.encoding));try{const e=a.parse(n.readFileSync(s,{encoding:t}));return Object.keys(e).forEach((function(s){Object.prototype.hasOwnProperty.call(process.env,s)?(!0===u&&(process.env[s]=e[s]),o&&c(!0===u?`"${s}" is already defined in \`process.env\` and WAS overwritten`:`"${s}" is already defined in \`process.env\` and was NOT overwritten`)):process.env[s]=e[s]})),{parsed:e}}catch(e){return o&&c(`Failed to load ${s} ${e.message}`),{error:e}}},parse:function(e){const s={};let t,n=e.toString();for(n=n.replace(/\r\n?/gm,"\n");null!=(t=o.exec(n));){const e=t[1];let n=t[2]||"";n=n.trim();const r=n[0];n=n.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===r&&(n=n.replace(/\\n/g,"\n"),n=n.replace(/\\r/g,"\r")),s[e]=n}return s}};e.exports.config=a.config,e.exports.parse=a.parse,e.exports=a},147:e=>{"use strict";e.exports=require("fs")},37:e=>{"use strict";e.exports=require("os")},17:e=>{"use strict";e.exports=require("path")}},s={};function t(n){var r=s[n];if(void 0!==r)return r.exports;var i=s[n]={exports:{}};return e[n](i,i.exports,t),i.exports}t.n=e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return t.d(s,{a:s}),s},t.d=(e,s)=>{for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})},t.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{"use strict";const e=require("http");t(371);var s=t(37),n=t.n(s);const r=require("cluster");var i=t.n(r);const o=require("crypto");var c=t.n(o);const a=new Uint8Array(256);let u=a.length;function d(){return u>a.length-16&&(c().randomFillSync(a),u=0),a.slice(u,u+=16)}const f=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,l=function(e){return"string"==typeof e&&f.test(e)},p=[];for(let e=0;e<256;++e)p.push((e+256).toString(16).substr(1));const g=function(e,s,t){const n=(e=e||{}).random||(e.rng||d)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,s){t=t||0;for(let e=0;e<16;++e)s[t+e]=n[e];return s}return function(e,s=0){const t=(p[e[s+0]]+p[e[s+1]]+p[e[s+2]]+p[e[s+3]]+"-"+p[e[s+4]]+p[e[s+5]]+"-"+p[e[s+6]]+p[e[s+7]]+"-"+p[e[s+8]]+p[e[s+9]]+"-"+p[e[s+10]]+p[e[s+11]]+p[e[s+12]]+p[e[s+13]]+p[e[s+14]]+p[e[s+15]]).toLowerCase();if(!l(t))throw TypeError("Stringified UUID is invalid");return t}(n)};var v=function(e,s,t,n){return new(t||(t=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var s;e.done?r(e.value):(s=e.value,s instanceof t?s:new t((function(e){e(s)}))).then(o,c)}a((n=n.apply(e,s||[])).next())}))},y=function(e,s,t,n){return new(t||(t=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var s;e.done?r(e.value):(s=e.value,s instanceof t?s:new t((function(e){e(s)}))).then(o,c)}a((n=n.apply(e,s||[])).next())}))};const h="Internal Server Error",O="Request Body Does Not Contain Required Fields",N="UserId Is Invalid (not uuid)",m="UserId Is Not Found",S=(e,s,t)=>{e.writeHead(s,{"Content-Type":"application/json"}),e.end(t)},E=new class{constructor(){this.users=[]}getUsers(){return v(this,void 0,void 0,(function*(){return this.users}))}findUser(e){return v(this,void 0,void 0,(function*(){return this.users.find((s=>s.id===e))||{username:"",age:0,hobbies:[]}}))}createUser(e){return v(this,void 0,void 0,(function*(){const s=JSON.parse(JSON.stringify(e));return s.id=this.createId(),this.users.push(s),s}))}updateUser(e){return v(this,void 0,void 0,(function*(){const s=JSON.parse(JSON.stringify(e));return this.users.forEach(((e,t)=>{e.id===s.id&&(this.users[t]=s)})),s}))}deleteUser(e){return v(this,void 0,void 0,(function*(){let s=null;this.users.forEach(((t,n)=>{t.id===e.id&&(s=n)})),s&&this.users.splice(s,1)}))}createId(){let e="",s=!1;for(;!s;){e=g();let t=!1;this.users.forEach((s=>{s.id===e&&(t=!0)})),t||(s=!0)}return e}},J=Number(process.env.PORT),b=(e,s)=>{const{method:t,url:n}=e;if(t&&n)if("GET"===t&&"/api/users"===n)((e,s)=>{y(void 0,void 0,void 0,(function*(){let t,n="";try{const e=yield s.getUsers();n=JSON.stringify(e),t=200}catch(e){n=JSON.stringify({message:h}),t=500}S(e,t,n)}))})(s,E);else if("GET"===t&&n.match(/\/api\/users\/([0-9a-zA-Z-]+)/)){const e=n.split("/")[3];((e,s,t)=>{y(void 0,void 0,void 0,(function*(){let n="",r=0;try{if(l(t)){const e=yield s.findUser(t);e.id?(n=JSON.stringify(e),r=200):(n=JSON.stringify({message:m}),r=404)}else n=JSON.stringify({message:N}),r=400}catch(e){n=JSON.stringify({message:h}),r=500}S(e,r,n)}))})(s,E,e)}else if("PUT"===t&&n.match(/\/api\/users\/([0-9a-zA-Z-]+)/)){const t=n.split("/")[3];((e,s,t,n)=>{y(void 0,void 0,void 0,(function*(){let r="",i=0;try{let o="";e.on("data",(e=>o+=e.toString())),e.on("end",(()=>y(void 0,void 0,void 0,(function*(){if(o){const{username:e,age:c,hobbies:a}=JSON.parse(o);if(e&&c&&a&&"string"==typeof e&&"number"==typeof c&&Array.isArray(a)){const s={username:e,age:c,hobbies:a,id:n};if(l(n))if((yield t.findUser(n)).id){const e=yield t.updateUser(s);r=JSON.stringify(e),i=200}else r=JSON.stringify({message:m}),i=404;else r=JSON.stringify({message:N}),i=400}else r=JSON.stringify({message:O}),i=400;S(s,i,r)}}))))}catch(e){r=JSON.stringify({message:h}),i=500,S(s,i,r)}}))})(e,s,E,t)}else if("DELETE"===t&&n.match(/\/api\/users\/([0-9a-zA-Z-]+)/)){const e=n.split("/")[3];((e,s,t)=>{y(void 0,void 0,void 0,(function*(){let n="",r=0;try{if(l(t)){const e=yield s.findUser(t);e.id?(yield s.deleteUser(e),n=JSON.stringify(""),r=204):(n=JSON.stringify({message:m}),r=404)}else n=JSON.stringify({message:N}),r=400}catch(e){n=JSON.stringify({message:h}),r=500}S(e,r,n)}))})(s,E,e)}else if("POST"===t&&"/api/users"===n)((e,s,t)=>{y(void 0,void 0,void 0,(function*(){let n,r="";try{let i="";e.on("data",(e=>i+=e.toString())),e.on("end",(()=>y(void 0,void 0,void 0,(function*(){if(i){const{username:e,age:o,hobbies:c}=JSON.parse(i);if(e&&o&&c&&"string"==typeof e&&"number"==typeof o&&Array.isArray(c)){const s={username:e,age:o,hobbies:c},i=yield t.createUser(s);r=JSON.stringify(i),n=201}else r=JSON.stringify({message:O}),n=400;S(s,n,r)}}))))}catch(e){r=JSON.stringify({message:h}),n=500,S(s,n,r)}}))})(e,s,E);else{const e=JSON.stringify({message:"Route Not Found"}),t=404;s.writeHead(t,{"Content-Type":"application/json"}),s.end(e)}},I=()=>{(0,e.createServer)(b).listen(J,"localhost",(()=>{console.log(`Сервер запущен на порту ${J}`)}))};3===process.argv.length&&"multi"===process.argv[2]?i().isPrimary?n().cpus().forEach((()=>{const e=i().fork();e.send(`Worker id: ${e.id} launched`)})):(I(),process.on("message",(e=>console.log(`Message from master: "${e}"`)))):I()})()})();